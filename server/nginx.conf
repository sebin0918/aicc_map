worker_processes auto;

events {
    worker_connections 1024;
}

http {
    # 로그 설정 (필요에 따라 설정)
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    # 업스트림 서버 (Node.js 애플리케이션) 정의
    upstream backend {
        server localhost:5000;  # Node.js 애플리케이션이 5000번 포트에서 실행 중인 경우
    }

    server {
        listen 80;  # Nginx가 요청을 수신할 포트 (HTTP)
        server_name localhost;  # 서버 이름 또는 도메인 이름

        # 정적 파일 서빙 설정 (필요한 경우)
        location /static/ {
            alias /app/static/;  # 정적 파일 경로
        }

        # 모든 요청을 Node.js 애플리케이션으로 프록시
        location / {
            proxy_pass http://backend;  # Node.js 애플리케이션으로 프록시
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_cache_bypass $http_upgrade;
        }
    }
}
