# Base image로 MariaDB 사용
FROM mariadb:latest

# 환경 변수 설정
ENV MYSQL_ROOT_PASSWORD=rootpassword
ENV MYSQL_DATABASE=map_database

# 작업 디렉토리 설정
WORKDIR /docker-entrypoint-initdb.d

# MariaDB 클라이언트 설치
RUN apt-get update && apt-get install -y mariadb-client
RUN apt-get install -y python3 python3-pip

# 초기화 SQL 파일 및 Python 스크립트, init_db.sh 복사
COPY MAP_project_create_table.sql /docker-entrypoint-initdb.d/
COPY MAP_project_DATABASE.py /docker-entrypoint-initdb.d/
COPY ./datas /docker-entrypoint-initdb.d/datas
COPY init_db.sh /docker-entrypoint-initdb.d/init_db.sh

# 스크립트에 실행 권한 부여
RUN chmod +x /docker-entrypoint-initdb.d/init_db.sh

# Init 스크립트 실행을 위한 entrypoint 설정
CMD ["bash", "/docker-entrypoint-initdb.d/init_db.sh"]
